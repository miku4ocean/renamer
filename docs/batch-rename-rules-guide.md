# 批次重新命名規則設定指南

## 📋 設定位置

在「指令區」工作表中：
- **B4 儲存格**：重新命名模式（下拉選單）
- **B5 儲存格**：參數設定（手動輸入）
- **B6 儲存格**：操作類型（下拉選單）

---

## 🏷️ **1. 新增文字模式**

### 設定方式
- **重新命名模式**：選擇「新增文字」
- **參數設定**：輸入以下格式之一

### 參數格式

#### 前綴（在檔名前面加文字）
```
前綴：要加的文字
```
**範例：**
- 參數：`前綴：IMG_`
- 原檔名：`photo.jpg`
- 結果：`IMG_photo.jpg`

#### 後綴（在檔名後面加文字）
```
後綴：要加的文字
```
**範例：**
- 參數：`後綴：_backup`
- 原檔名：`document.pdf`
- 結果：`document_backup.pdf`

#### 前後皆加（前面和後面都加文字）
```
前後皆加：要加的文字
```
**範例：**
- 參數：`前後皆加：[重要]`
- 原檔名：`report.xlsx`
- 結果：`[重要]report[重要].xlsx`

---

## 🔄 **2. 取代文字模式**

### 設定方式
- **重新命名模式**：選擇「取代文字」
- **參數設定**：輸入以下格式之一

### 參數格式

#### 完全取代（整個檔名都換掉）
```
完全取代：新的檔名
```
**範例：**
- 參數：`完全取代：新報告`
- 原檔名：`舊報告.docx`
- 結果：`新報告.docx`

#### 部分取代（只換特定文字）
```
部分取代：要找的文字→要換成的文字
```
**範例：**
- 參數：`部分取代：draft→final`
- 原檔名：`project_draft_v1.txt`
- 結果：`project_final_v1.txt`

---

## 📝 **3. 大小寫轉換模式**

### 設定方式
- **重新命名模式**：選擇「大小寫轉換」
- **參數設定**：選擇以下之一

### 參數選項
- `全部大寫` - 所有字母變大寫
- `全部小寫` - 所有字母變小寫  
- `首字母大寫` - 第一個字母大寫，其他小寫

**範例：**
- 原檔名：`MyDocument.PDF`
- 全部小寫：`mydocument.pdf`
- 全部大寫：`MYDOCUMENT.PDF`
- 首字母大寫：`Mydocument.pdf`

---

## 🔢 **4. 新增序號模式**

### 設定方式
- **重新命名模式**：選擇「新增序號」
- **參數設定**：輸入以下格式之一

### 參數格式
```
位置類型：起始數字,位數
```

#### 前綴序號（序號在檔名前面）
```
前綴序號：1,3
```
**範例：**
- 參數：`前綴序號：1,3`（從1開始，3位數）
- 原檔名：`photo.jpg`, `image.png`, `video.mp4`
- 結果：`001_photo.jpg`, `002_image.png`, `003_video.mp4`

#### 後綴序號（序號在檔名後面）
```
後綴序號：10,2
```
**範例：**
- 參數：`後綴序號：10,2`（從10開始，2位數）
- 原檔名：`file.txt`, `data.csv`
- 結果：`file_10.txt`, `data_11.csv`

#### 插入序號（序號用括號包起來）
```
插入序號：1,4
```
**範例：**
- 參數：`插入序號：1,4`（從1開始，4位數）
- 原檔名：`report.pdf`, `summary.docx`
- 結果：`report(0001).pdf`, `summary(0002).docx`

---

## 📅 **5. 格式化日期模式**

### 設定方式
- **重新命名模式**：選擇「格式化日期」
- **參數設定**：選擇以下格式之一

### 參數格式
```
日期格式：格式代碼
```

#### 可用的日期格式
- `日期格式：YYYY-MM-DD` → `2024-03-15_檔名.pdf`
- `日期格式：YYYYMMDD` → `20240315_檔名.pdf`
- `日期格式：DD-MM-YYYY` → `15-03-2024_檔名.pdf`

**範例：**
- 參數：`日期格式：YYYY-MM-DD`
- 原檔名：`report.xlsx`（最後修改：2024年3月15日）
- 結果：`2024-03-15_report.xlsx`

---

## 🔧 **操作類型設定**

在 B6 儲存格選擇：

### 原位置更名
- 直接修改原檔案的名稱
- 檔案位置不變
- **風險較高**：建議先備份

### 複製後更名
- 複製檔案到目標資料夾並重新命名
- 原檔案保持不變
- **較安全**：需要在 B3 設定目標資料夾ID

---

## 📊 **完整設定範例**

### 範例1：為照片加上日期前綴
```
B4: 格式化日期
B5: 日期格式：YYYY-MM-DD
B6: 原位置更名
```
結果：`photo.jpg` → `2024-03-15_photo.jpg`

### 範例2：為文件加上序號
```
B4: 新增序號
B5: 前綴序號：1,3
B6: 原位置更名
```
結果：`doc1.pdf`, `doc2.pdf` → `001_doc1.pdf`, `002_doc2.pdf`

### 範例3：批次改檔名格式
```
B4: 大小寫轉換
B5: 全部小寫
B6: 複製後更名
```
結果：`MyFile.PDF` → `myfile.pdf`（複製到新位置）

### 範例4：取代檔名關鍵字
```
B4: 取代文字
B5: 部分取代：temp→final
B6: 原位置更名
```
結果：`temp_report.docx` → `final_report.docx`

---

## ⚠️ **注意事項**

1. **參數格式必須精確**：冒號、箭頭符號都要正確
2. **先測試**：使用「套用批次規則」預覽效果
3. **備份重要檔案**：特別是使用「原位置更名」時
4. **檢查重複檔名**：系統會警告重複的檔名

---

## 🚀 **操作流程**

1. **設定規則**：在指令區填入上述參數
2. **預覽效果**：點擊「套用批次規則」
3. **檢查結果**：查看「檔名變更區」的預覽
4. **執行重新命名**：確認無誤後點擊「開始重新命名」

這樣您就能輕鬆進行批次檔案重新命名了！