# Renamer 安裝與設定指南

## 概述

本指南將協助您完成 Renamer 工具的完整安裝與設定，讓您能夠在 Google Drive 中進行高效的批次檔案重新命名。

## 前置需求

- Google 帳號
- Google Drive 存取權限
- 基本的 Google Sheets 操作能力

## 安裝步驟

### 步驟 1：建立 Google Apps Script 專案

1. 前往 [Google Apps Script](https://script.google.com/)
2. 點擊「新建立專案」
3. 將專案重新命名為「Renamer」

### 步驟 2：上傳程式碼檔案

#### 2.1 建立主要程式檔案

1. 刪除預設的 `Code.gs` 檔案內容
2. 複製 `/src/Code.js` 的內容並貼到 `Code.gs` 中
3. 儲存檔案

#### 2.2 新增額外模組

1. 點擊左側「檔案」旁的「+」號
2. 選擇「指令碼」
3. 建立以下檔案：

**FileOperations.gs**
- 複製 `/src/FileOperations.js` 的內容

**BatchRename.gs**
- 複製 `/src/BatchRename.js` 的內容

#### 2.3 設定專案資訊

1. 點擊左側「專案設定」
2. 在「指令碼屬性」中設定：
   - 時區：`Asia/Taipei`
3. 複製 `appsscript.json` 的內容到專案資訊檔中

### 步驟 3：設定權限

1. 點擊「執行」按鈕測試 `onOpen` 函數
2. 系統會要求授權，點擊「檢閱權限」
3. 選擇您的 Google 帳號
4. 點擊「進階」→「前往 Renamer（不安全）」
5. 點擊「允許」授予以下權限：
   - 查看和管理您的 Google Drive 檔案
   - 查看和管理您擁有的試算表

### 步驟 4：建立工作資料夾

1. 前往 [Google Drive](https://drive.google.com/)
2. 建立一個新資料夾（例如：「測試重新命名」）
3. 在資料夾中放入一些測試檔案
4. 記下資料夾的 ID（URL 中的長串字元）

### 步驟 5：建立 Google Sheets 工作表

#### 5.1 建立新的試算表

1. 在同一個資料夾中建立新的 Google Sheets
2. 將試算表命名為與資料夾相同的名稱
3. 開啟試算表

#### 5.2 設定工作表結構

**建立「指令區」工作表：**

1. 將預設工作表重新命名為「指令區」
2. 按照 `/templates/command-sheet-template.md` 的格式設定儲存格：

| A | B |
|---|---|
| 檔案重新命名指令區 |  |
| 來源資料夾： | [貼上您的資料夾 ID] |
| 目標資料夾（複製模式）： |  |
| 重新命名模式： | 新增文字 |
| 參數設定： | 前綴：IMG_ |
| 操作類型： | 原位置更名 |

**建立「檔名變更區」工作表：**

1. 新增工作表，命名為「檔名變更區」
2. 設定標題列：

| A | B | C | D | E | F | G |
|---|---|---|---|---|---|---|
| 原檔名 | 原檔案路徑 | 變更後檔名 | 變更後檔案路徑 | 檔案類型 | 檔案大小 (bytes) | 最後修改時間 |

#### 5.3 套用格式與驗證

參考 `/templates/filelist-sheet-template.md` 設定：
- 標題列格式（粗體、背景色）
- 條件格式（變更檔名高亮顯示）
- 資料驗證規則
- 自動篩選功能

### 步驟 6：連結 Apps Script 與 Sheets

1. 在 Google Sheets 中，前往「擴充功能」→「Apps Script」
2. 系統會開啟 Apps Script 編輯器
3. 確認已正確載入所有程式碼檔案
4. 返回 Google Sheets，重新整理頁面

### 步驟 7：測試安裝

1. 在 Google Sheets 中，您應該會看到新的選單「檔案重新命名工具」
2. 確認「指令區」的 B2 儲存格已填入正確的資料夾 ID
3. 點擊選單中的「讀取資料夾檔案」
4. 檢查「檔名變更區」是否正確顯示資料夾中的檔案

## 設定完成檢查清單

- [ ] Google Apps Script 專案已建立
- [ ] 所有程式碼檔案已上傳
- [ ] 權限已正確授予
- [ ] 工作資料夾已建立並包含測試檔案
- [ ] Google Sheets 已建立並正確設定
- [ ] 工作表結構符合模板規格
- [ ] 自訂選單正常顯示
- [ ] 檔案讀取功能正常運作

## 常見問題排除

### 問題 1：沒有看到自訂選單
**解決方案：**
- 重新整理 Google Sheets 頁面
- 確認 Apps Script 程式碼已正確儲存
- 檢查是否有語法錯誤

### 問題 2：讀取檔案失敗
**解決方案：**
- 確認資料夾 ID 正確
- 檢查 Google Drive 檔案權限
- 確認 Apps Script 已獲得必要權限

### 問題 3：權限被拒絕
**解決方案：**
- 重新執行授權流程
- 確認使用正確的 Google 帳號
- 清除瀏覽器快取並重試

### 問題 4：程式執行錯誤
**解決方案：**
- 檢查 Apps Script 的執行記錄
- 確認所有檔案都已正確上傳
- 檢查工作表名稱是否正確

## 進階設定

### 自訂時區設定
如需修改時區，請編輯 `appsscript.json` 中的 `timeZone` 設定。

### 效能最佳化
對於大量檔案的處理，建議：
- 分批處理檔案
- 適當使用 Google Apps Script 的執行時間限制
- 考慮使用觸發器進行背景處理

### 備份設定
建議定期備份：
- Google Apps Script 程式碼
- 重要的 Google Sheets 檔案
- 處理記錄

## 下一步

安裝完成後，請參考 `/docs/user-manual.md` 了解詳細的使用方法和功能介紹。