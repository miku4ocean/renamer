# Renamer 使用者手冊

## 目錄
1. [功能概述](#功能概述)
2. [基本操作流程](#基本操作流程)
3. [重新命名模式](#重新命名模式)
4. [進階功能](#進階功能)
5. [常見使用場景](#常見使用場景)
6. [注意事項](#注意事項)
7. [故障排除](#故障排除)

## 功能概述

Renamer 是一個基於 Google Apps Script 的批次檔案重新命名工具，提供以下主要功能：

- 🔍 **檔案掃描**: 自動讀取 Google Drive 資料夾中的所有檔案
- 🏷️ **批次重新命名**: 支援多種命名規則和模式
- 📋 **可視化管理**: 透過 Google Sheets 界面進行直觀操作
- 🔄 **雙重模式**: 支援原位置更名和複製後更名
- 📊 **詳細記錄**: 完整的操作歷史和檔案資訊追蹤

## 基本操作流程

### 步驟 1：準備工作環境

1. 開啟您已設定好的 Google Sheets 檔案
2. 確認「指令區」和「檔名變更區」兩個工作表都存在
3. 準備要處理的 Google Drive 資料夾

### 步驟 2：設定來源資料夾

1. 切換到「指令區」工作表
2. 在 B2 儲存格輸入資料夾 ID 或完整 URL：
   ```
   資料夾 ID: 1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms
   或
   完整 URL: https://drive.google.com/drive/folders/1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms
   ```

### 步驟 3：讀取檔案資訊

1. 點擊頂部選單「檔案重新命名工具」
2. 選擇「讀取資料夾檔案」
3. 等待系統處理完成
4. 切換到「檔名變更區」查看讀取結果

### 步驟 4：設定重新命名規則

1. 返回「指令區」工作表
2. 在 B4 儲存格選擇重新命名模式
3. 在 B5 儲存格設定對應參數
4. 在 B6 儲存格選擇操作類型

### 步驟 5：執行重新命名

1. 點擊選單「檔案重新命名工具」→「開始重新命名」
2. 確認預覽結果
3. 執行批次處理

## 重新命名模式

### 1. 新增文字模式

在現有檔名的前面、後面或前後同時新增文字。

**參數格式:**
- 前綴：`前綴：IMG_`
- 後綴：`後綴：_backup`
- 前後皆加：`前後皆加：[完成]`

**範例:**
- 原檔名：`document.pdf`
- 前綴設定：`前綴：重要_`
- 結果：`重要_document.pdf`

### 2. 取代文字模式

將檔名中的特定文字替換為新文字。

**參數格式:**
- 完全取代：`完全取代：新檔名`
- 部分取代：`部分取代：舊文字→新文字`

**範例:**
- 原檔名：`project_draft_v1.docx`
- 部分取代：`部分取代：draft→final`
- 結果：`project_final_v1.docx`

### 3. 大小寫轉換模式

改變檔名的大小寫格式。

**支援選項:**
- `全部大寫`
- `全部小寫`
- `首字母大寫`

**範例:**
- 原檔名：`MyDocument.PDF`
- 全部小寫設定
- 結果：`mydocument.pdf`

### 4. 新增序號模式

為檔案新增數字序號。

**參數格式:**
- 前綴序號：`前綴序號：1,3` （起始數字：1，位數：3）
- 後綴序號：`後綴序號：10,2`
- 插入序號：`插入序號：1,4`

**範例:**
- 原檔名：`photo.jpg`
- 前綴序號設定：`前綴序號：1,3`
- 結果：`001_photo.jpg`, `002_photo.jpg`, `003_photo.jpg`...

### 5. 格式化日期模式

根據檔案的最後修改時間新增日期。

**支援格式:**
- `日期格式：YYYY-MM-DD`
- `日期格式：YYYYMMDD`
- `日期格式：DD-MM-YYYY`

**範例:**
- 原檔名：`report.xlsx`
- 設定：`日期格式：YYYY-MM-DD`
- 結果：`2024-03-15_report.xlsx`

## 進階功能

### 手動調整檔名

1. 在「檔名變更區」工作表中
2. 直接編輯 C 欄（變更後檔名）的內容
3. 系統會自動更新 D 欄（變更後檔案路徑）

### 複製後更名模式

1. 在「指令區」B3 儲存格設定目標資料夾
2. 將 B6 儲存格設定為「複製後更名」
3. 執行重新命名時，檔案會被複製到目標資料夾

### 條件格式輔助

「檔名變更區」工作表提供以下視覺提示：
- **藍色背景**: 檔名有變更
- **紅色背景**: 檔名重複（警告）
- **橘色背景**: 檔名包含不合法字元

### 批次清除功能

使用選單「檔案重新命名工具」→「清除所有資料」可快速清空所有檔案記錄。

## 常見使用場景

### 場景 1：相片檔案整理

**需求**: 將旅遊照片統一加上日期前綴

**設定步驟:**
1. 重新命名模式：`格式化日期`
2. 參數設定：`日期格式：YYYY-MM-DD`
3. 操作類型：`原位置更名`

**結果**: `IMG_001.jpg` → `2024-03-15_IMG_001.jpg`

### 場景 2：工作文件版本管理

**需求**: 將草稿文件改為正式版本

**設定步驟:**
1. 重新命名模式：`取代文字`
2. 參數設定：`部分取代：草稿→正式版`
3. 操作類型：`複製後更名`

**結果**: `報告_草稿.docx` → `報告_正式版.docx`（複製到新資料夾）

### 場景 3：檔案序號整理

**需求**: 為散亂的檔案新增連續序號

**設定步驟:**
1. 重新命名模式：`新增序號`
2. 參數設定：`前綴序號：1,3`
3. 操作類型：`原位置更名`

**結果**: 檔案會變成 `001_filename`, `002_filename`...

### 場景 4：檔名格式統一

**需求**: 將所有檔名轉為小寫

**設定步驟:**
1. 重新命名模式：`大小寫轉換`
2. 參數設定：`全部小寫`
3. 操作類型：`原位置更名`

## 注意事項

### ⚠️ 重要提醒

1. **備份重要檔案**: 執行重新命名前請備份重要資料
2. **檔名限制**: 避免使用 `/ \ : * ? " < > |` 等特殊字元
3. **重複檔名**: 系統會警告重複檔名，請手動調整
4. **權限檢查**: 確保對目標資料夾有寫入權限

### 📝 操作建議

1. **小批次測試**: 首次使用時建議先處理少量檔案
2. **預覽確認**: 執行前仔細檢查「檔名變更區」的預覽結果
3. **記錄保存**: 重要操作建議截圖或匯出記錄
4. **定期清理**: 處理完成後清除舊的記錄資料

### 🔧 效能考量

1. **檔案數量**: 建議單次處理不超過 1000 個檔案
2. **執行時間**: Google Apps Script 有 6 分鐘執行限制
3. **網路穩定**: 確保網路連線穩定，避免中途中斷

## 故障排除

### 問題 1: 讀取檔案失敗

**可能原因:**
- 資料夾 ID 錯誤
- 權限不足
- 資料夾不存在

**解決方法:**
1. 檢查資料夾 ID 是否正確
2. 確認對資料夾有存取權限
3. 重新授權 Apps Script 權限

### 問題 2: 重新命名失敗

**可能原因:**
- 檔名包含不合法字元
- 目標檔名已存在
- 權限不足

**解決方法:**
1. 檢查檔名格式是否正確
2. 處理重複檔名衝突
3. 確認寫入權限

### 問題 3: 程式執行超時

**可能原因:**
- 檔案數量過多
- 網路速度緩慢

**解決方法:**
1. 分批處理檔案
2. 檢查網路連線
3. 減少同時處理的檔案數量

### 問題 4: 選單不顯示

**可能原因:**
- Apps Script 未正確載入
- 權限未授予
- 程式碼錯誤

**解決方法:**
1. 重新整理頁面
2. 重新執行 `onOpen` 函數
3. 檢查程式碼是否有錯誤

## 聯絡支援

如遇到其他問題，請：
1. 檢查 Google Apps Script 的執行記錄
2. 參考 GitHub 專案的 Issue 頁面
3. 提供詳細的錯誤訊息和操作步驟

---

*最後更新: 2024年3月*