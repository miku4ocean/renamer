# Google Sheets 模板格式設定教學

## 📋 總覽

本教學將逐步引導您完成 Renamer 工具在 Google Sheets 中的格式設定，包括兩個工作表的完整配置。

---

## 🔧 準備工作

### 1. 建立 Google Sheets 檔案
1. 前往 [Google Sheets](https://sheets.google.com/)
2. 點擊「空白」建立新試算表
3. 將檔案重新命名（建議與您的資料夾同名）

### 2. 建立工作表
1. 將預設工作表重新命名為「指令區」
2. 點擊左下角 ➕ 新增工作表
3. 將新工作表命名為「檔名變更區」

---

## 📝 指令區工作表格式設定

### 步驟 1：建立基本結構

在「指令區」工作表中輸入以下內容：

| A欄 | B欄 |
|-----|-----|
| 檔案重新命名指令區 |  |
| 來源資料夾： | 請輸入資料夾ID或URL |
| 目標資料夾（複製模式）： |  |
| 重新命名模式： | 新增文字 |
| 參數設定： | 前綴：IMG_ |
| 操作類型： | 原位置更名 |

### 步驟 2：格式化標題列（A1:B1）

1. **選取範圍**：點擊 A1，拖曳至 B1
2. **合併儲存格**：
   - 工具列 → 「合併儲存格」→「水平合併」
3. **設定字型**：
   - 點擊「B」（粗體）按鈕
   - 字型大小選擇「14」
4. **設定對齊**：
   - 點擊「置中對齊」按鈕
5. **設定背景色**：
   - 點擊「填滿顏色」→ 選擇淺藍色 `#E1F5FE`

### 步驟 3：格式化標籤欄（A2:A6）

1. **選取範圍**：點擊 A2，拖曳至 A6
2. **設定字型**：
   - 點擊「B」（粗體）按鈕
   - 字型大小保持「10」或「11」
3. **設定對齊**：
   - 點擊「靠右對齊」按鈕
4. **設定背景色**：
   - 點擊「填滿顏色」→ 選擇淺灰色 `#F5F5F5`

### 步驟 4：格式化輸入欄（B2:B6）

1. **選取範圍**：點擊 B2，拖曳至 B6
2. **設定對齊**：
   - 點擊「靠左對齊」按鈕
3. **新增邊框**：
   - 工具列 → 「邊框」→ 選擇「所有邊框」

### 步驟 5：設定資料驗證

**B4 儲存格（重新命名模式）：**
1. 選取 B4 儲存格
2. 點擊「資料」→「資料驗證」
3. 條件：「清單（來源：範圍）」
4. 輸入項目：`新增文字,取代文字,大小寫轉換,新增序號,格式化日期`
5. 點擊「完成」

**B6 儲存格（操作類型）：**
1. 選取 B6 儲存格
2. 點擊「資料」→「資料驗證」
3. 條件：「清單（來源：範圍）」
4. 輸入項目：`原位置更名,複製後更名`
5. 點擊「完成」

### 步驟 6：調整欄寬

1. 將滑鼠移到 A 和 B 欄之間的分隔線
2. 拖曳調整 A 欄寬度約 200px
3. 調整 B 欄寬度約 300px

---

## 📂 檔名變更區工作表格式設定

### 步驟 1：建立標題列

在「檔名變更區」工作表的第一列輸入：

| A1 | B1 | C1 | D1 | E1 | F1 | G1 |
|----|----|----|----|----|----|----|
| 原檔名 | 原檔案路徑 | 變更後檔名 | 變更後檔案路徑 | 檔案類型 | 檔案大小 (bytes) | 最後修改時間 |

### 步驟 2：格式化標題列（A1:G1）

1. **選取範圍**：點擊 A1，拖曳至 G1
2. **設定字型**：
   - 點擊「B」（粗體）按鈕
   - 字型大小選擇「12」
   - 文字顏色選擇「白色」
3. **設定背景色**：
   - 點擊「填滿顏色」→ 選擇深藍色 `#1976D2`
4. **設定對齊**：
   - 點擊「置中對齊」按鈕

### 步驟 3：凍結標題列

1. 選取 A2 儲存格
2. 點擊「檢視」→「凍結」→「截至目前列」

### 步驟 4：設定欄寬

建議欄寬設定：
- A欄（原檔名）：150px
- B欄（原檔案路徑）：200px  
- C欄（變更後檔名）：150px
- D欄（變更後檔案路徑）：200px
- E欄（檔案類型）：120px
- F欄（檔案大小）：100px
- G欄（最後修改時間）：140px

### 步驟 5：新增範例資料

在第2-4列新增範例資料：

| A | B | C | D | E | F | G |
|---|---|---|---|---|---|---|
| document.pdf | 測試資料夾/document.pdf | IMG_document.pdf | 測試資料夾/IMG_document.pdf | application/pdf | 1024 | 2024/03/15 10:30:00 |
| image.jpg | 測試資料夾/image.jpg | IMG_image.jpg | 測試資料夾/IMG_image.jpg | image/jpeg | 2048 | 2024/03/16 14:20:00 |

### 步驟 6：設定條件格式

**高亮顯示已變更的檔名：**

1. 選取範圍 C2:C1000
2. 點擊「格式」→「條件格式」
3. 條件類型：「自訂公式為」
4. 輸入公式：`=$C2<>$A2`
5. 格式設定：
   - 背景色：淺藍色 `#E3F2FD`
   - 文字色：深藍色 `#1976D2`
6. 點擊「完成」

**警告重複檔名：**

1. 選取範圍 C2:C1000
2. 點擊「格式」→「條件格式」→「新增其他規則」
3. 條件類型：「自訂公式為」
4. 輸入公式：`=COUNTIF($C$2:$C2,$C2)>1`
5. 格式設定：
   - 背景色：淺紅色 `#FFEBEE`
   - 文字色：深紅色 `#D32F2F`
6. 點擊「完成」

### 步驟 7：設定自動篩選

1. 選取範圍 A1:G1000
2. 點擊「資料」→「建立篩選器」
3. 確認標題列出現篩選下拉箭頭

---

## 🎨 進階格式設定（可選）

### 交替行顏色

1. 選取整個資料範圍（A1:G1000）
2. 點擊「格式」→「交替顏色」
3. 選擇喜歡的配色方案
4. 確認「標題」選項已勾選
5. 點擊「完成」

### 資料驗證增強

為重要欄位新增資料驗證：

**F欄（檔案大小）：**
- 條件：「數字」→「大於等於」→「0」
- 錯誤訊息：「檔案大小必須為正數」

**G欄（修改時間）：**
- 條件：「日期」
- 錯誤訊息：「請輸入有效的日期時間格式」

---

## ✅ 格式設定完成檢查清單

### 指令區工作表：
- [ ] 標題列已合併並設定藍色背景
- [ ] 標籤欄設定灰色背景和粗體
- [ ] 輸入欄對齊格式正確
- [ ] 重新命名模式有下拉選單
- [ ] 操作類型有下拉選單
- [ ] 欄寬調整適中

### 檔名變更區工作表：
- [ ] 標題列設定深藍背景白字
- [ ] 標題列已凍結
- [ ] 欄寬設定合理
- [ ] 條件格式正確顯示變更檔名
- [ ] 自動篩選功能啟用
- [ ] 範例資料已新增

### 整體檢查：
- [ ] 兩個工作表名稱正確
- [ ] Apps Script 已連結（見下一步）
- [ ] 所有格式顯示正常

---

## 🔗 下一步：連結 Apps Script

完成格式設定後，請按照以下步驟連結程式碼：

1. 在 Google Sheets 中點擊「擴充功能」→「Apps Script」
2. 刪除預設程式碼
3. 複製專案中的程式碼檔案內容
4. 儲存並測試功能

---

## 💡 常見問題

**Q: 條件格式沒有生效怎麼辦？**
A: 檢查公式是否正確，確認範圍設定無誤，可以先測試小範圍再擴大。

**Q: 下拉選單沒有顯示怎麼辦？**
A: 重新設定資料驗證，確認輸入的選項用逗號分隔且沒有多餘空格。

**Q: 格式設定後看起來不對怎麼辦？**
A: 可以使用「格式」→「清除格式」重新開始，或參考 HTML 模板的視覺效果。

**Q: 如何快速套用格式？**
A: 可以使用「格式複製程式」功能，先設定好一個儲存格的格式，再複製到其他儲存格。

---

*完成這些設定後，您的 Google Sheets 就準備好使用 Renamer 工具了！*