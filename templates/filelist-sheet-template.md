# 檔名變更區工作表模板

## 工作表名稱
`檔名變更區`

## 工作表結構

| 欄位 | 說明 | 寬度 | 格式 |
|------|------|------|------|
| A | 原檔名 | 150px | 文字 |
| B | 原檔案路徑 | 200px | 文字 |
| C | 變更後檔名 | 150px | 文字 |
| D | 變更後檔案路徑 | 200px | 文字 |
| E | 檔案類型 | 100px | 文字 |
| F | 檔案大小 | 80px | 數字 |
| G | 最後修改時間 | 120px | 日期時間 |

## 標題列設定

| 欄位 | 標題 |
|------|------|
| A1 | 原檔名 |
| B1 | 原檔案路徑 |
| C1 | 變更後檔名 |
| D1 | 變更後檔案路徑 |
| E1 | 檔案類型 |
| F1 | 檔案大小 (bytes) |
| G1 | 最後修改時間 |

## 工作表格式設定

### 標題列格式 (A1:G1)
- **字體**: 粗體，12pt，白色
- **對齊**: 置中
- **背景色**: 深藍色 (#1976D2)
- **邊框**: 白色，1px
- **凍結**: 凍結第一列

### 資料列格式 (A2:G∞)
- **字體**: 一般，10pt
- **對齊**: 靠左（文字）、靠右（數字）
- **交替背景色**: 白色 / 淺灰色 (#F8F9FA)
- **邊框**: 淺灰色，1px

### 特殊格式設定

#### 原檔名欄 (A)
- **字體色彩**: 黑色 (#000000)
- **背景**: 白色或淺灰色（交替）

#### 變更後檔名欄 (C)
- **字體色彩**: 深藍色 (#1976D2)
- **背景**: 淺藍色 (#E3F2FD)（如有變更）
- **條件格式**: 若與原檔名不同，背景變為淺藍色

#### 檔案大小欄 (F)
- **數字格式**: `#,##0` bytes
- **對齊**: 靠右

#### 最後修改時間欄 (G)
- **日期格式**: `YYYY/MM/DD HH:MM:SS`
- **對齊**: 置中

## 條件格式規則

### 變更檔名高亮顯示
- **範圍**: C2:C1000
- **條件**: `=$C2<>$A2`
- **格式**: 背景色 #E3F2FD，字體色 #1976D2

### 重複檔名警告
- **範圍**: C2:C1000
- **條件**: `=COUNTIF($C$2:$C2,$C2)>1`
- **格式**: 背景色 #FFEBEE，字體色 #D32F2F

### 無效檔名警告
- **範圍**: C2:C1000
- **條件**: `=OR(ISERROR(FIND("/",C2)),ISERROR(FIND("\\",C2)),ISERROR(FIND(":",C2)),ISERROR(FIND("*",C2)),ISERROR(FIND("?",C2)),ISERROR(FIND("\"",C2)),ISERROR(FIND("<",C2)),ISERROR(FIND(">",C2)),ISERROR(FIND("|",C2)))`
- **格式**: 背景色 #FFF3E0，字體色 #E65100

## 資料驗證

### 檔案大小欄 (F)
- **類型**: 數字
- **條件**: 大於等於 0
- **錯誤訊息**: "檔案大小必須為正數"

### 修改時間欄 (G)
- **類型**: 日期時間
- **錯誤訊息**: "請輸入有效的日期時間格式"

## 篩選與排序

### 自動篩選
- **範圍**: A1:G1000
- **啟用**: 所有欄位都可篩選

### 預設排序
- **主要**: 原檔名 (A欄) - 升序
- **次要**: 最後修改時間 (G欄) - 降序

## 欄位說明

### 原檔名 (A)
從 Google Drive 讀取的原始檔案名稱，包含副檔名。

### 原檔案路徑 (B)
檔案在 Google Drive 中的完整路徑，格式：`資料夾名稱/檔案名稱`

### 變更後檔名 (C)
**可編輯欄位**，使用者可手動修改或透過批次功能自動填入。

### 變更後檔案路徑 (D)
變更後的完整檔案路徑，會根據操作類型自動更新：
- 原位置更名：`原資料夾名稱/變更後檔名`
- 複製後更名：`目標資料夾名稱/變更後檔名`

### 檔案類型 (E)
檔案的 MIME 類型，例如：
- `application/pdf`
- `image/jpeg`
- `text/plain`

### 檔案大小 (F)
檔案大小，單位為 bytes，以數字格式顯示並加上千分位符號。

### 最後修改時間 (G)
檔案的最後修改時間，格式為 `YYYY/MM/DD HH:MM:SS`。

## 操作按鈕位置建議

在工作表右側或下方預留空間，用於放置操作按鈕：
- **讀取檔案** (已在選單中)
- **套用批次規則**
- **預覽變更**
- **執行重新命名**
- **清除資料** (已在選單中)

## 使用流程

1. 透過「指令區」設定好參數
2. 使用選單功能「讀取資料夾檔案」
3. 檔案資訊會自動填入此工作表的 A、B、E、F、G 欄
4. C 欄會根據批次規則自動產生建議檔名
5. 使用者可手動調整 C 欄的檔名
6. D 欄會自動根據 C 欄和操作類型更新
7. 執行重新命名功能

## 注意事項

- 請勿手動修改 A、B、E、F、G 欄，這些是系統自動產生的資料
- C 欄是主要的編輯欄位，可自由修改
- 注意避免檔名包含不合法字元：/ \ : * ? " < > |
- 建議定期備份重要檔案